<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/favicon-v2.ico" />
    <title>Available for Sourcing | Dialed By H — Luxury Watch Concierge</title>
    <meta name="description" content="Browse pieces currently available for sourcing through Dialed By H. Rolex, Patek Philippe, Audemars Piguet, Richard Mille and more. Inquire to source.">
    <meta name="keywords" content="luxury watch sourcing, rolex, patek philippe, audemars piguet, richard mille, rare watch sourcing, watch concierge, dialed by h">
    <meta name="author" content="Henry Ohler">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://dialedbyhenry.com/inventory.html">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://dialedbyhenry.com/inventory.html">
    <meta property="og:title" content="Available for Sourcing | Dialed By H">
    <meta property="og:description" content="Browse rare luxury watches available for sourcing through Dialed By H concierge service.">
    <meta property="og:image" content="https://dialedbyhenry.com/images/logo.png">
    <meta property="og:site_name" content="Dialed By H">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Available for Sourcing | Dialed By H">
    <meta name="twitter:description" content="Browse rare luxury watches available for sourcing through Dialed By H.">

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "CollectionPage",
        "name": "Dialed By H — Pieces for Sourcing",
        "description": "Browse rare and authenticated luxury watches available for concierge sourcing through Dialed By H.",
        "url": "https://dialedbyhenry.com/inventory.html",
        "provider": {
            "@type": "Organization",
            "name": "Dialed By H",
            "url": "https://dialedbyhenry.com"
        }
    }
    </script>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans+Text" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        charcoal: '#0a0a0a',
                        ivory: '#f0f0f0',
                        muted: '#888888',
                    },
                    fontFamily: {
                        space: ['"Space Grotesk"', 'sans-serif'],
                        inter: ['"Inter"', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        @import url(https://fonts.googleapis.com/css?family=Google+Sans+Text);
        html {
            font-family: 'Google Sans Text', 'Google Sans';
            font-size: 14px;
            margin: 0;
            padding: 0;
            background: #0a0a0a;
            color: #f0f0f0;
        }
        body {
            margin: 0;
            padding: 0;
            background-color: #0a0a0a;
            color: #f0f0f0;
            overflow-x: hidden;
            text-transform: uppercase;
        }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0a0a0a; }
        ::-webkit-scrollbar-thumb { background: #333; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
        .nav-link { position: relative; }
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 1px;
            background: #f0f0f0;
            transition: width 0.3s ease;
        }
        .nav-link:hover::after { width: 100%; }

        .glass {
            background: rgba(255,255,255,0.03);
            backdrop-filter: blur(20px) saturate(1.4);
            -webkit-backdrop-filter: blur(20px) saturate(1.4);
            border: 1px solid rgba(255,255,255,0.08);
        }
        .glass-strong {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(40px) saturate(1.6);
            -webkit-backdrop-filter: blur(40px) saturate(1.6);
            border: 1px solid rgba(255,255,255,0.12);
        }
        .glass-subtle {
            background: rgba(255,255,255,0.02);
            backdrop-filter: blur(12px) saturate(1.2);
            -webkit-backdrop-filter: blur(12px) saturate(1.2);
            border: 1px solid rgba(255,255,255,0.05);
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* ── BLURRED BACKGROUND MOSAIC ── */
        #bg-mosaic {
            position: fixed;
            inset: 0;
            z-index: 0;
            overflow: hidden;
            pointer-events: none;
        }
        #bg-mosaic .bg-img {
            position: absolute;
            width: 280px;
            height: 280px;
            object-fit: cover;
            border-radius: 24px;
            filter: blur(40px) saturate(1.5);
            opacity: 0.06;
        }

        /* ── WATCH CARD ── */
        .watch-card {
            position: relative;
            overflow: hidden;
            border-radius: 16px;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.06);
            transition: transform 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease;
            cursor: pointer;
        }
        .watch-card:hover {
            transform: translateY(-6px);
            border-color: rgba(255,255,255,0.15);
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        .watch-card .card-img {
            transition: transform 0.7s ease;
        }
        .watch-card:hover .card-img {
            transform: scale(1.06);
        }
        .watch-card .card-overlay {
            background: linear-gradient(0deg, rgba(10,10,10,0.85) 0%, rgba(10,10,10,0.1) 50%, transparent 100%);
            transition: opacity 0.5s ease;
        }
        .watch-card:hover .card-overlay {
            opacity: 0.9;
        }
        .watch-card .card-cta {
            opacity: 0;
            transform: translateY(8px);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }
        .watch-card:hover .card-cta {
            opacity: 1;
            transform: translateY(0);
        }

        /* ── FILTER PILLS ── */
        .brand-pill {
            background: rgba(245,243,235,0.04);
            color: rgba(245,243,235,0.35);
            padding: 6px 16px;
            border-radius: 9999px;
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 700;
            font-size: 10px;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            transition: all 0.25s ease;
            border: 1px solid rgba(245,243,235,0.08);
            cursor: pointer;
        }
        .brand-pill:hover { background: rgba(245,243,235,0.1); color: rgba(245,243,235,0.7); border-color: rgba(245,243,235,0.15); }
        .brand-pill.active {
            background: rgba(245,243,235,0.1);
            color: rgba(245,243,235,0.95);
            border-color: rgba(245,243,235,0.2);
        }

        /* Subtle shimmer on brand pills to draw attention */
        @keyframes pill-shimmer {
            0%, 100% { border-color: rgba(245,243,235,0.06); }
            50% { border-color: rgba(245,243,235,0.18); }
        }
        .brand-pill:not(.active) {
            animation: pill-shimmer 3s ease-in-out infinite;
        }
        .brand-pill:not(.active):hover { animation: none; }

        /* Subtle pulse on filter bar border */
        @keyframes filter-glow {
            0%, 100% { border-color: rgba(245,243,235,0.05); }
            50% { border-color: rgba(245,243,235,0.12); }
        }
        .filter-bar-animate {
            animation: filter-glow 4s ease-in-out infinite;
        }

        .filter-select-wrap select {
            background: transparent;
            border: none;
            outline: none;
            color: rgba(245,243,235,0.45);
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 700;
            font-size: 10px;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            cursor: pointer;
            padding: 4px 8px;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            transition: color 0.2s ease;
            text-align: center;
            text-align-last: center;
        }
        .filter-select-wrap select:hover,
        .filter-select-wrap select:focus { color: rgba(245,243,235,0.8); }
        .filter-select-wrap select.active-filter { color: rgba(245,243,235,0.95); }
        .filter-select-wrap { position: relative; }
        .filter-select-wrap::after {
            content: '▾';
            position: absolute;
            right: 2px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 8px;
            color: rgba(245,243,235,0.25);
            pointer-events: none;
        }
        .filter-select-wrap select { padding-right: 14px; }
        .filter-select-wrap select option { background: #1a1a1a; color: #f5f3eb; }

        @media (max-width: 639px) {
            #bg-mosaic .bg-img { width: 180px; height: 180px; filter: blur(30px) saturate(1.3); opacity: 0.05; }
        }
    </style>
</head>
<body class="min-h-screen bg-charcoal text-ivory selection:bg-ivory selection:text-charcoal font-inter">

    <!-- BLURRED PHOTO BACKGROUND -->
    <div id="bg-mosaic"></div>

    <!-- NAV -->
    <nav class="w-full z-40 px-6 sm:px-10 md:px-16 py-5 sm:py-6 flex justify-between items-center relative">
        <a href="index.html">
            <img src="images/logo.png" alt="Dialed By H" class="h-8 sm:h-10 w-auto object-contain">
        </a>
        <div class="hidden md:flex space-x-8 text-sm font-space font-medium uppercase tracking-widest items-center">
            <a href="about.html" class="nav-link hover:text-muted transition-colors">About Me</a>
            <a href="process.html" class="nav-link hover:text-muted transition-colors">My Process</a>
            <a href="https://dialedbyh.substack.com" target="_blank" rel="noopener noreferrer" class="nav-link hover:text-muted transition-colors">Journal</a>
            <a href="index.html" class="bg-ivory text-charcoal px-5 py-2 text-xs font-bold font-space uppercase tracking-widest hover:bg-muted hover:text-white transition-colors">Back to Home</a>
        </div>
        <button onclick="document.getElementById('mobile-menu').style.opacity='1'; document.getElementById('mobile-menu').style.pointerEvents='auto'; document.body.style.overflow='hidden';" class="md:hidden text-ivory">
            <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                <path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/>
            </svg>
        </button>
    </nav>

    <!-- MOBILE MENU -->
    <div id="mobile-menu" class="fixed inset-0 z-50 bg-charcoal/95 backdrop-blur-sm flex flex-col items-center justify-center space-y-8 transition-all duration-500 opacity-0 pointer-events-none">
        <button onclick="document.getElementById('mobile-menu').style.opacity='0'; document.getElementById('mobile-menu').style.pointerEvents='none'; document.body.style.overflow='';" class="absolute top-4 right-6 text-ivory">
            <svg width="28" height="28" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path d="M18 6L6 18M6 6l12 12"/>
            </svg>
        </button>
        <a href="about.html" class="text-2xl font-space font-bold uppercase tracking-widest hover:text-muted transition-colors">About Me</a>
        <a href="process.html" class="text-2xl font-space font-bold uppercase tracking-widest hover:text-muted transition-colors">My Process</a>
        <a href="https://dialedbyh.substack.com" target="_blank" rel="noopener noreferrer" class="text-2xl font-space font-bold uppercase tracking-widest hover:text-muted transition-colors">Journal</a>
        <a href="index.html" class="bg-ivory text-charcoal px-8 py-3 text-sm font-bold font-space uppercase tracking-widest hover:bg-muted hover:text-white transition-colors">Back to Home</a>
    </div>

    <!-- CONTENT -->
    <main class="relative z-10 max-w-7xl mx-auto px-6 pt-20 sm:pt-28 pb-12 sm:pb-16">

        <!-- HEADER -->
        <h1 id="hero-title" class="font-space font-bold text-3xl sm:text-5xl md:text-6xl lg:text-8xl tracking-tighter uppercase leading-[1.15] opacity-0 mb-12 sm:mb-16">
            Available for <span class="text-muted">Sourcing</span>
        </h1>

        <!-- SUBTITLE -->
        <p id="hero-sub" class="font-inter text-muted text-sm sm:text-base max-w-xl opacity-0 leading-relaxed mb-14 sm:mb-20" style="letter-spacing: 0.15em;">
            Browse pieces I can currently source. Inquire on any reference and I'll handle the rest.
        </p>

        <!-- FILTER SYSTEM -->
        <div class="mb-10 sm:mb-14" id="filter-bar">
            <!-- Brand pills — horizontal scroll on mobile, wrap on desktop -->
            <div class="flex sm:flex-wrap gap-2 mb-5 overflow-x-auto no-scrollbar pb-1" id="brand-pills">
                <button onclick="selectBrand('ALL')" class="brand-pill active shrink-0" data-brand="ALL">All</button>
            </div>

            <!-- Filter row -->
            <div class="glass-subtle rounded-xl px-4 sm:px-6 py-3 filter-bar-animate">
                <!-- MOBILE: 2x2 grid + sort row -->
                <div class="sm:hidden">
                    <div class="grid grid-cols-2 gap-2 mb-2">
                        <div class="filter-select-wrap">
                            <select id="filter-model-m" onchange="syncFilter('filter-model', this.value); applyFilters()" class="w-full">
                                <option value="ALL">Model</option>
                            </select>
                        </div>
                        <div class="filter-select-wrap">
                            <select id="filter-dial-m" onchange="syncFilter('filter-dial', this.value); applyFilters()" class="w-full">
                                <option value="ALL">Dial Color</option>
                            </select>
                        </div>
                        <div class="filter-select-wrap">
                            <select id="filter-material-m" onchange="syncFilter('filter-material', this.value); applyFilters()" class="w-full">
                                <option value="ALL">Case Material</option>
                            </select>
                        </div>
                        <div class="filter-select-wrap">
                            <select id="filter-condition-m" onchange="syncFilter('filter-condition', this.value); applyFilters()" class="w-full">
                                <option value="ALL">Condition</option>
                            </select>
                        </div>
                    </div>
                    <div class="flex items-center justify-between pt-2 border-t border-ivory/5">
                        <div class="filter-select-wrap">
                            <select id="sort-by-m" onchange="syncFilter('sort-by', this.value); applyFilters()" class="w-full">
                                <option value="default">Sort By</option>
                                <option value="year-new">Newest</option>
                                <option value="year-old">Oldest</option>
                                <option value="model-az">Model A → Z</option>
                            </select>
                        </div>
                        <div class="flex items-center gap-3">
                            <span id="result-count-m" class="text-[10px] font-space tracking-widest text-ivory/25 whitespace-nowrap"></span>
                            <button onclick="resetFilters()" id="reset-btn-m" class="hidden text-[10px] font-space font-bold tracking-widest text-ivory/30 hover:text-ivory transition-colors whitespace-nowrap">
                                ✕ Clear
                            </button>
                        </div>
                    </div>
                </div>

                <!-- DESKTOP: single row -->
                <div class="hidden sm:flex items-center">
                    <div class="flex items-center flex-1">
                        <div class="filter-select-wrap flex-1 flex justify-center">
                            <select id="filter-model" onchange="applyFilters()" class="text-center">
                                <option value="ALL">Model</option>
                            </select>
                        </div>
                        <span class="text-ivory/10 shrink-0">|</span>
                        <div class="filter-select-wrap flex-1 flex justify-center">
                            <select id="filter-dial" onchange="applyFilters()" class="text-center">
                                <option value="ALL">Dial Color</option>
                            </select>
                        </div>
                        <span class="text-ivory/10 shrink-0">|</span>
                        <div class="filter-select-wrap flex-1 flex justify-center">
                            <select id="filter-material" onchange="applyFilters()" class="text-center">
                                <option value="ALL">Case Material</option>
                            </select>
                        </div>
                        <span class="text-ivory/10 shrink-0">|</span>
                        <div class="filter-select-wrap flex-1 flex justify-center">
                            <select id="filter-condition" onchange="applyFilters()" class="text-center">
                                <option value="ALL">Condition</option>
                            </select>
                        </div>
                        <span class="text-ivory/10 shrink-0">|</span>
                        <div class="filter-select-wrap flex-1 flex justify-center">
                            <select id="sort-by" onchange="applyFilters()" class="text-center">
                                <option value="default">Sort By</option>
                                <option value="year-new">Newest</option>
                                <option value="year-old">Oldest</option>
                                <option value="model-az">Model A → Z</option>
                            </select>
                        </div>
                    </div>
                    <span class="text-ivory/10 shrink-0 mx-3">|</span>
                    <div class="flex items-center gap-3 shrink-0">
                        <span id="result-count" class="text-[10px] font-space tracking-widest text-ivory/25 whitespace-nowrap"></span>
                        <button onclick="resetFilters()" id="reset-btn" class="hidden text-[10px] font-space font-bold tracking-widest text-ivory/30 hover:text-ivory transition-colors whitespace-nowrap">
                            ✕ Clear
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- WATCH GRID -->
        <div id="watch-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 sm:gap-6 lg:gap-7">
        </div>

        <!-- EMPTY STATE -->
        <div id="empty-state" class="hidden text-center py-20">
            <p class="text-muted font-space tracking-widest text-sm">No pieces match this filter.</p>
        </div>

        <!-- CTA -->
        <div class="mt-16 sm:mt-24 text-center glass rounded-2xl p-8 sm:p-12">
            <h2 class="font-space font-bold text-2xl sm:text-3xl tracking-tight mb-4">Don't See What You're Looking For?</h2>
            <p class="text-muted text-sm sm:text-base font-inter tracking-wide mb-8 max-w-lg mx-auto">
                I source watches globally through my network. Tell me what you're after and I'll find it.
            </p>
            <button onclick="openSourceRequest()" class="bg-ivory text-charcoal px-8 py-4 font-bold font-space uppercase tracking-widest hover:bg-white transition-colors">
                Submit a Sourcing Request
            </button>
        </div>
    </main>

    <!-- FOOTER -->
    <footer class="relative z-10 px-6 py-16 sm:py-20 border-t border-ivory/10 text-center overflow-hidden">
        <div class="footer-content">
            <p class="footer-line text-muted text-xs font-space uppercase tracking-[0.3em] mb-4 opacity-0">Authenticated Timepieces. Global Sourcing.</p>
            <div class="footer-line flex justify-center gap-8 sm:gap-12 mb-6 opacity-0">
                <a href="https://www.instagram.com/dialedbyh/" target="_blank" rel="noopener noreferrer" class="text-muted hover:text-ivory transition-colors">
                    <i data-lucide="instagram" class="w-5 h-5"></i>
                </a>
                <a href="https://wa.me/19146211848" target="_blank" rel="noopener noreferrer" class="text-muted hover:text-ivory transition-colors">
                    <i data-lucide="message-circle" class="w-5 h-5"></i>
                </a>
                <a href="mailto:dialedbyh@gmail.com" target="_blank" rel="noopener noreferrer" class="text-muted hover:text-ivory transition-colors">
                    <i data-lucide="mail" class="w-5 h-5"></i>
                </a>
            </div>
            <span class="footer-line block mt-6 text-xs text-muted/60 font-space uppercase tracking-widest opacity-0">&copy; 2026 DIALED BY H</span>
            <p class="footer-line opacity-0 text-[10px] text-muted/30 font-inter max-w-lg mx-auto mb-6 leading-relaxed" style="text-transform: none; font-style: italic;">Dialed By H is an independent sourcing firm and is not affiliated with Rolex, Patek Philippe, Audemars Piguet, or any respective brand. All trademarks belong to their respective owners. Images are used for identification purposes only.</p>
        </div>
    </footer>

    <!-- INQUIRY MODAL -->
    <div id="modal-overlay" class="fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-xl opacity-0" style="visibility:hidden; pointer-events:none;">
        <div class="w-full max-w-lg glass-strong m-3 sm:m-4 relative shadow-2xl overflow-hidden rounded-2xl">
            <button onclick="closeModal()"
                    class="absolute top-3 right-3 z-30 w-9 h-9 flex items-center justify-center bg-charcoal/80 backdrop-blur-sm border border-ivory/20 rounded-full text-muted hover:text-ivory hover:bg-charcoal transition-all duration-200">
                <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path d="M18 6L6 18M6 6l12 12"/>
                </svg>
            </button>
            <div id="modal-body" class="space-y-4"></div>
        </div>
    </div>

    <!-- SUCCESS OVERLAY -->
    <div id="success-overlay" class="fixed inset-0 z-[60] flex items-center justify-center opacity-0" style="visibility:hidden; pointer-events:none;">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-xl"></div>
        <div class="relative z-10 glass-strong rounded-2xl p-8 sm:p-12 max-w-sm mx-4 text-center">
            <button onclick="closeSuccessOverlay()" class="absolute top-3 right-3 w-9 h-9 flex items-center justify-center bg-charcoal/80 backdrop-blur-sm border border-ivory/20 rounded-full text-muted hover:text-ivory hover:bg-charcoal transition-all duration-200">
                <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M18 6L6 18M6 6l12 12"/></svg>
            </button>
            <div class="w-16 h-16 border border-ivory rounded-full flex items-center justify-center mb-6 mx-auto">
                <i data-lucide="check" class="w-8 h-8"></i>
            </div>
            <h3 class="text-xl font-space font-bold tracking-widest mb-2">Request Received</h3>
            <p class="text-muted text-xs tracking-wide">Henry will contact you shortly.</p>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <script>
        let PIECES = [];

        async function fetchPieces() {
            try {
                const res = await fetch('/.netlify/functions/get-inventory');
                if (!res.ok) throw new Error('Failed to fetch');
                PIECES = await res.json();
                return PIECES;
            } catch (err) {
                console.error('Failed to fetch pieces from Notion:', err);
                return [];
            }
        }

        /* ── BLURRED BACKGROUND MOSAIC ── */
        function buildBackground(pieces) {
            const container = document.getElementById('bg-mosaic');
            const withImages = pieces.filter(p => p.image);
            if (!withImages.length) return;

            // Place images in a scattered grid pattern
            const count = Math.min(withImages.length, 20);
            const shuffled = withImages.sort(() => Math.random() - 0.5).slice(0, count);
            const cols = 5;
            const rows = Math.ceil(count / cols);

            shuffled.forEach((p, i) => {
                const img = document.createElement('img');
                img.src = p.image;
                img.alt = '';
                img.className = 'bg-img';
                img.loading = 'lazy';
                // Scatter across viewport
                const col = i % cols;
                const row = Math.floor(i / cols);
                const x = (col / cols) * 100 + (Math.random() * 10 - 5);
                const y = (row / rows) * 100 + (Math.random() * 10 - 5);
                img.style.left = x + '%';
                img.style.top = y + '%';
                img.style.transform = `rotate(${Math.random() * 30 - 15}deg)`;
                container.appendChild(img);
            });
        }

        /* ── RENDER GRID ── */
        function renderGrid(items) {
            const grid = document.getElementById('watch-grid');
            const empty = document.getElementById('empty-state');

            if (items.length === 0) {
                grid.innerHTML = '';
                empty.classList.remove('hidden');
                return;
            }

            empty.classList.add('hidden');
            grid.innerHTML = items.map(w => {
                const name = w.name || '';
                const ref = w.ref || '';
                const nickname = w.nickname ? ` "${w.nickname}"` : '';
                const details = w.details || '';
                const image = w.image || '';
                const condLabel = w.condition || '';
                const setLabel = w.set || '';
                const year = w.year || '';
                const brand = (w.brand || '').toUpperCase();
                const imgSize = brand === 'ROLEX' ? '95%' : brand.includes('AUDEMARS') ? '65%' : brand.includes('RICHARD') ? '150%' : '75%';

                return `
                <a href="watch.html?id=${w.id}" class="watch-card group block">
                    <div class="relative aspect-square overflow-hidden rounded-t-2xl bg-[#111] flex items-center justify-center">
                        ${image
                            ? `<img src="${image}" alt="${name}" class="card-img object-contain" style="width:${imgSize};height:${imgSize}" loading="lazy">`
                            : `<div class="w-full h-full bg-gradient-to-b from-charcoal/30 to-charcoal/80 flex items-center justify-center">
                                <span class="text-muted/40 text-xs font-space tracking-widest">Image Coming Soon</span>
                               </div>`
                        }
                        <div class="card-overlay absolute inset-0"></div>
                        <!-- Info overlay at bottom -->
                        <div class="absolute bottom-0 left-0 right-0 p-5">
                            <div class="card-cta">
                                <span class="inline-block glass-strong rounded-full px-5 py-2.5 text-[10px] font-space font-bold tracking-widest">
                                    View Details →
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="p-5">
                        <h3 class="font-space font-bold text-base sm:text-lg tracking-tight leading-snug mb-1">${name}${nickname}</h3>
                        ${ref ? `<p class="text-muted text-[11px] font-bold tracking-widest mb-2">Ref. ${ref}</p>` : ''}
                        ${details ? `<p class="text-ivory/40 text-[11px] font-inter tracking-wide mb-3">${details}</p>` : ''}
                        <div class="flex items-center gap-2 flex-wrap">
                            ${condLabel ? `<span class="text-[9px] font-space font-bold tracking-widest text-ivory/50 bg-ivory/5 px-2.5 py-1 rounded-full">${condLabel}</span>` : ''}
                            ${setLabel ? `<span class="text-[9px] font-space tracking-widest text-ivory/35 bg-ivory/5 px-2.5 py-1 rounded-full">${setLabel}</span>` : ''}
                            ${year ? `<span class="text-[9px] font-space tracking-widest text-ivory/30">${year}</span>` : ''}
                        </div>
                    </div>
                </a>
            `}).join('');

            lucide.createIcons();
        }

        /* ── FILTERS ── */
        function syncFilter(desktopId, value) {
            const el = document.getElementById(desktopId);
            if (el) el.value = value;
        }

        let activeBrand = 'ALL';

        function stopFilterAnimations() {
            document.querySelectorAll('.brand-pill:not(.active)').forEach(p => p.style.animation = 'none');
            const bar = document.querySelector('.filter-bar-animate');
            if (bar) bar.classList.remove('filter-bar-animate');
        }

        function selectBrand(brand) {
            stopFilterAnimations();
            activeBrand = brand;
            document.querySelectorAll('.brand-pill').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.brand === brand);
            });
            applyFilters();
        }

        function highlightActiveSelects() {
            ['filter-model', 'filter-dial', 'filter-material', 'filter-condition', 'sort-by'].forEach(id => {
                const el = document.getElementById(id);
                if (!el) return;
                el.classList.toggle('active-filter', el.value !== 'ALL' && el.value !== 'default');
            });
        }

        function isFiltered() {
            return activeBrand !== 'ALL' ||
                document.getElementById('filter-model').value !== 'ALL' ||
                document.getElementById('filter-dial').value !== 'ALL' ||
                document.getElementById('filter-material').value !== 'ALL' ||
                document.getElementById('filter-condition').value !== 'ALL' ||
                document.getElementById('sort-by').value !== 'default';
        }

        function applyFilters() {
            stopFilterAnimations();
            let filtered = [...PIECES];

            if (activeBrand !== 'ALL') filtered = filtered.filter(w => w.brand === activeBrand);

            const model = document.getElementById('filter-model').value;
            if (model !== 'ALL') filtered = filtered.filter(w => w.model === model);

            const dial = document.getElementById('filter-dial').value;
            if (dial !== 'ALL') filtered = filtered.filter(w => w.dialColor === dial);

            const mat = document.getElementById('filter-material').value;
            if (mat !== 'ALL') filtered = filtered.filter(w => w.caseMaterial === mat);

            const cond = document.getElementById('filter-condition').value;
            if (cond !== 'ALL') filtered = filtered.filter(w => w.condition === cond);

            const sort = document.getElementById('sort-by').value;
            if (sort === 'year-new') filtered.sort((a, b) => (Number(b.year) || 0) - (Number(a.year) || 0));
            if (sort === 'year-old') filtered.sort((a, b) => (Number(a.year) || 0) - (Number(b.year) || 0));
            if (sort === 'model-az') filtered.sort((a, b) => (a.model || '').localeCompare(b.model || ''));

            const countText = filtered.length + ' piece' + (filtered.length !== 1 ? 's' : '');
            ['result-count', 'result-count-m'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.textContent = countText;
            });
            const hasFilters = isFiltered();
            ['reset-btn', 'reset-btn-m'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.classList.toggle('hidden', !hasFilters);
            });
            highlightActiveSelects();
            renderGrid(filtered);

            gsap.from('#watch-grid .watch-card', {
                opacity: 0, y: 30, duration: 0.5, stagger: 0.04, ease: 'power2.out'
            });
        }

        function resetFilters() {
            activeBrand = 'ALL';
            document.querySelectorAll('.brand-pill').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.brand === 'ALL');
            });
            ['filter-model','filter-dial','filter-material','filter-condition'].forEach(id => {
                const d = document.getElementById(id);
                const m = document.getElementById(id + '-m');
                if (d) d.value = 'ALL';
                if (m) m.value = 'ALL';
            });
            const sb = document.getElementById('sort-by');
            const sbm = document.getElementById('sort-by-m');
            if (sb) sb.value = 'default';
            if (sbm) sbm.value = 'default';
            applyFilters();
        }

        /* ── MODALS ── */
        function openModal() {
            const overlay = document.getElementById('modal-overlay');
            overlay.style.visibility = 'visible';
            overlay.style.pointerEvents = 'auto';
            gsap.to(overlay, { opacity: 1, duration: 0.4, ease: 'power2.out' });
            gsap.fromTo(overlay.querySelector(':scope > div'),
                { y: 20, opacity: 0, scale: 0.98 },
                { y: 0, opacity: 1, scale: 1, duration: 0.5, ease: 'power3.out' }
            );
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            const overlay = document.getElementById('modal-overlay');
            gsap.to(overlay.querySelector(':scope > div'),
                { y: 20, opacity: 0, scale: 0.98, duration: 0.3, ease: 'power2.in' }
            );
            gsap.to(overlay, {
                opacity: 0, duration: 0.4, delay: 0.1,
                onComplete: () => {
                    overlay.style.visibility = 'hidden';
                    overlay.style.pointerEvents = 'none';
                    document.body.style.overflow = '';
                }
            });
        }

        const WATCH_BRANDS = {
            'Rolex': ['Daytona','Submariner','GMT-Master II','Explorer','Explorer II','Datejust','Day-Date','Sky-Dweller','Yacht-Master','Sea-Dweller','Milgauss','Air-King','Cellini','Other'],
            'Patek Philippe': ['Nautilus','Aquanaut','Calatrava','Grand Complications','Complications','Twenty~4','Golden Ellipse','Other'],
            'Audemars Piguet': ['Royal Oak','Royal Oak Offshore','Royal Oak Concept','Code 11.59','Millenary','Other'],
            'Richard Mille': ['RM 11','RM 35','RM 55','RM 67','RM 17','RM 27','RM 72','Other'],
            'F.P. Journe': ['Chronometre Bleu','Chronometre Souverain','Octa','Tourbillon Souverain','Centigraphe','Elegante','Other'],
            'Vacheron Constantin': ['Overseas','Patrimony','Traditionnelle','Historiques','Fiftysix','Other'],
            'A. Lange & Sohne': ['Lange 1','Saxonia','Zeitwerk','Datograph','1815','Odysseus','Other'],
            'Omega': ['Speedmaster','Seamaster','Constellation','De Ville','Aqua Terra','Planet Ocean','Other'],
            'Cartier': ['Santos','Tank','Ballon Bleu','Panthere','Pasha','Drive','Other'],
            'IWC': ['Portugieser','Pilot','Aquatimer','Ingenieur','Portofino','Other'],
            'Panerai': ['Luminor','Submersible','Radiomir','Due','Other'],
            'Hublot': ['Big Bang','Classic Fusion','Spirit of Big Bang','Other'],
            'Tudor': ['Black Bay','Pelagos','Ranger','1926','Other'],
            'Breitling': ['Navitimer','Chronomat','Superocean','Avenger','Premier','Other'],
            'Jaeger-LeCoultre': ['Reverso','Master','Polaris','Atmos','Other'],
            'Blancpain': ['Fifty Fathoms','Villeret','Ladybird','Other'],
            'Breguet': ['Classique','Marine','Tradition','Type XX','Other'],
            'Girard-Perregaux': ['Laureato','1966','Bridges','Other'],
            'Other': ['Other']
        };

        function updateModels(brand) {
            const select = document.getElementById('model-select');
            const models = WATCH_BRANDS[brand] || [];
            select.innerHTML = '<option value="" class="bg-charcoal">Select Model</option>' +
                models.map(m => '<option value="'+m+'" class="bg-charcoal">'+m+'</option>').join('');
        }

        function openSourceRequest() {
            const body = document.getElementById('modal-body');
            body.innerHTML = `
                <div id="form-view" class="p-5 sm:p-8">
                    <h2 class="text-2xl font-space font-bold tracking-tight mb-2">Sourcing Request</h2>
                    <p class="text-xs text-muted mb-8 tracking-wide">Tell me what you're looking for and I'll source it.</p>
                    <form onsubmit="event.preventDefault(); submitSourceRequest(this);" class="space-y-4">
                        <div>
                            <label class="block text-[10px] font-bold tracking-widest text-muted mb-2">Full Name</label>
                            <input required type="text" name="fullName" class="w-full bg-transparent border border-ivory/20 p-3 text-ivory focus:border-ivory outline-none transition-colors uppercase">
                        </div>
                        <div>
                            <label class="block text-[10px] font-bold tracking-widest text-muted mb-2">Email</label>
                            <input required type="email" name="email" class="w-full bg-transparent border border-ivory/20 p-3 text-ivory focus:border-ivory outline-none transition-colors uppercase">
                        </div>
                        <div>
                            <label class="block text-[10px] font-bold tracking-widest text-muted mb-2">Brand</label>
                            <select name="watchBrand" required onchange="updateModels(this.value)"
                                class="w-full bg-charcoal border border-ivory/20 p-3 text-ivory focus:border-ivory outline-none transition-colors uppercase appearance-none cursor-pointer">
                                <option value="" class="bg-charcoal">Select Brand</option>
                                ${Object.keys(WATCH_BRANDS).map(b => '<option value="'+b+'" class="bg-charcoal">'+b+'</option>').join('')}
                            </select>
                        </div>
                        <div>
                            <label class="block text-[10px] font-bold tracking-widest text-muted mb-2">Model</label>
                            <select name="watchModel" required id="model-select"
                                class="w-full bg-charcoal border border-ivory/20 p-3 text-ivory focus:border-ivory outline-none transition-colors uppercase appearance-none cursor-pointer">
                                <option value="" class="bg-charcoal">Select Brand First</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-[10px] font-bold tracking-widest text-muted mb-2">Reference Number (if known)</label>
                            <input type="text" name="watchRef" placeholder="e.g. 126500LN" class="w-full bg-transparent border border-ivory/20 p-3 text-ivory focus:border-ivory outline-none transition-colors uppercase placeholder-muted/40">
                        </div>
                        <div class="pt-2 pb-1">
                            <p class="text-[10px] font-bold tracking-widest text-muted mb-3">Your Preferences</p>
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-[9px] font-bold tracking-widest text-muted/60 mb-1.5">Preferred Year</label>
                                    <select name="prefYear" class="w-full bg-charcoal border border-ivory/20 p-3 text-ivory focus:border-ivory outline-none transition-colors uppercase appearance-none cursor-pointer text-xs">
                                        <option value="" class="bg-charcoal">Any Year</option>
                                        <option value="2025" class="bg-charcoal">2025</option>
                                        <option value="2024" class="bg-charcoal">2024</option>
                                        <option value="2023" class="bg-charcoal">2023</option>
                                        <option value="2022" class="bg-charcoal">2022</option>
                                        <option value="2021" class="bg-charcoal">2021</option>
                                        <option value="2020" class="bg-charcoal">2020</option>
                                        <option value="2019 or older" class="bg-charcoal">2019 or Older</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-[9px] font-bold tracking-widest text-muted/60 mb-1.5">Condition</label>
                                    <select name="prefCondition" class="w-full bg-charcoal border border-ivory/20 p-3 text-ivory focus:border-ivory outline-none transition-colors uppercase appearance-none cursor-pointer text-xs">
                                        <option value="" class="bg-charcoal">Any Condition</option>
                                        <option value="Brand New" class="bg-charcoal">Brand New</option>
                                        <option value="Like New" class="bg-charcoal">Like New</option>
                                        <option value="Excellent" class="bg-charcoal">Excellent</option>
                                        <option value="Very Good" class="bg-charcoal">Very Good</option>
                                        <option value="Good" class="bg-charcoal">Good</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-[9px] font-bold tracking-widest text-muted/60 mb-1.5">Set</label>
                                    <select name="prefSet" class="w-full bg-charcoal border border-ivory/20 p-3 text-ivory focus:border-ivory outline-none transition-colors uppercase appearance-none cursor-pointer text-xs">
                                        <option value="" class="bg-charcoal">Any Set</option>
                                        <option value="Full Set" class="bg-charcoal">Full Set</option>
                                        <option value="Partial Set" class="bg-charcoal">Partial Set</option>
                                        <option value="Watch Only" class="bg-charcoal">Watch Only</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-[9px] font-bold tracking-widest text-muted/60 mb-1.5">Price Range</label>
                                    <select name="prefPrice" class="w-full bg-charcoal border border-ivory/20 p-3 text-ivory focus:border-ivory outline-none transition-colors uppercase appearance-none cursor-pointer text-xs">
                                        <option value="" class="bg-charcoal">Any Budget</option>
                                        <option value="Under $10K" class="bg-charcoal">Under $10K</option>
                                        <option value="$10K - $25K" class="bg-charcoal">$10K - $25K</option>
                                        <option value="$25K - $50K" class="bg-charcoal">$25K - $50K</option>
                                        <option value="$50K - $100K" class="bg-charcoal">$50K - $100K</option>
                                        <option value="$100K - $250K" class="bg-charcoal">$100K - $250K</option>
                                        <option value="$250K+" class="bg-charcoal">$250K+</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div>
                            <label class="block text-[10px] font-bold tracking-widest text-muted mb-2">Additional Details</label>
                            <textarea rows="2" name="watchDetails" placeholder="Any other questions or details..." class="w-full bg-transparent border border-ivory/20 p-3 text-ivory focus:border-ivory outline-none transition-colors uppercase placeholder-muted/40"></textarea>
                        </div>
                        <button type="submit" class="w-full bg-ivory text-charcoal py-4 font-bold font-space tracking-widest hover:bg-white transition-colors mt-4">
                            Submit Sourcing Request
                        </button>
                    </form>
                </div>
            `;
            lucide.createIcons();
            openModal();
        }

        function showSuccess() {
            // Close the form modal first
            closeModal();
            // Show centered success overlay
            setTimeout(() => {
                const overlay = document.getElementById('success-overlay');
                overlay.style.visibility = 'visible';
                overlay.style.pointerEvents = 'auto';
                document.body.style.overflow = 'hidden';
                gsap.to(overlay, { opacity: 1, duration: 0.4, ease: 'power2.out' });
                gsap.fromTo(overlay.querySelector('.glass-strong'),
                    { y: 20, opacity: 0, scale: 0.95 },
                    { y: 0, opacity: 1, scale: 1, duration: 0.5, ease: 'power3.out' }
                );
                lucide.createIcons();
            }, 500);
        }

        function closeSuccessOverlay() {
            const overlay = document.getElementById('success-overlay');
            gsap.to(overlay.querySelector('.glass-strong'),
                { y: 20, opacity: 0, scale: 0.95, duration: 0.3, ease: 'power2.in' }
            );
            gsap.to(overlay, {
                opacity: 0, duration: 0.4, delay: 0.1,
                onComplete: () => {
                    overlay.style.visibility = 'hidden';
                    overlay.style.pointerEvents = 'none';
                    document.body.style.overflow = '';
                }
            });
        }

        async function submitSourceRequest(formEl) {
            const btn = formEl.querySelector('button[type="submit"]');
            const formData = new FormData(formEl);
            const brand = formData.get('watchBrand') || '';
            const model = formData.get('watchModel') || '';
            const ref = formData.get('watchRef') || '';
            const details = formData.get('watchDetails') || '';

            // Build preferences string
            const prefs = [];
            const prefYear = formData.get('prefYear');
            const prefCondition = formData.get('prefCondition');
            const prefSet = formData.get('prefSet');
            const prefPrice = formData.get('prefPrice');
            if (prefYear) prefs.push('Year: ' + prefYear);
            if (prefCondition) prefs.push('Condition: ' + prefCondition);
            if (prefSet) prefs.push('Set: ' + prefSet);
            if (prefPrice) prefs.push('Budget: ' + prefPrice);
            const prefsStr = prefs.length ? 'Preferences: ' + prefs.join(', ') : '';

            let watchDetailsStr = '';
            if (brand || model) {
                const parts = [brand, model, ref ? 'Ref: ' + ref : ''].filter(Boolean);
                watchDetailsStr = parts.join(' — ');
            }
            const allDetails = [watchDetailsStr, prefsStr, details].filter(Boolean).join(' | ');

            const payload = {
                type: 'BUY',
                fullName: formData.get('fullName'),
                email: formData.get('email'),
                watchName: brand && model ? brand + ' ' + model : null,
                watchRef: ref || null,
                watchDetails: allDetails || null
            };

            if (btn) { btn.innerText = 'Processing...'; btn.disabled = true; }

            try {
                const res = await fetch('/.netlify/functions/submit-form', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                if (!res.ok) throw new Error('Submission failed');
                showSuccess();
            } catch (error) {
                console.error('Submission error:', error);
                if (window.location.protocol === 'file:' || (window.location.hostname === 'localhost' && error.message.includes('Failed to fetch'))) {
                    showSuccess();
                    return;
                }
                if (btn) { btn.innerText = 'Error - Try Again'; btn.disabled = false; }
            }
        }

        /* ── POPULATE FILTER DROPDOWNS ── */
        function populateDropdown(ids, values, defaultLabel) {
            ids.forEach(id => {
                const sel = document.getElementById(id);
                if (!sel) return;
                sel.innerHTML = `<option value="ALL">${defaultLabel}</option>`;
                values.forEach(v => {
                    const opt = document.createElement('option');
                    opt.value = v; opt.textContent = v;
                    sel.appendChild(opt);
                });
            });
        }

        /* ── INIT ── */
        document.addEventListener('DOMContentLoaded', async () => {
            lucide.createIcons();
            gsap.registerPlugin(ScrollTrigger);

            gsap.from('nav', { opacity: 0, y: -30, duration: 1, ease: 'power3.out' });
            gsap.to('#hero-title', { opacity: 1, y: 0, duration: 1.2, ease: 'expo.out', delay: 0.3 });
            gsap.from('#hero-title', { y: 80, duration: 1.2, ease: 'expo.out', delay: 0.3 });
            gsap.to('#hero-sub', { opacity: 1, y: 0, duration: 0.8, ease: 'power2.out', delay: 0.7 });
            gsap.from('#hero-sub', { y: 30, duration: 0.8, ease: 'power2.out', delay: 0.7 });

            await fetchPieces();

            // Build blurred background mosaic from piece images
            buildBackground(PIECES);

            // Build brand pills from data
            const brands = [...new Set(PIECES.map(w => w.brand).filter(Boolean))].sort();
            const pillContainer = document.getElementById('brand-pills');
            brands.forEach(b => {
                const btn = document.createElement('button');
                btn.onclick = () => selectBrand(b);
                btn.className = 'brand-pill shrink-0';
                btn.dataset.brand = b;
                btn.textContent = b;
                pillContainer.appendChild(btn);
            });

            // Populate filter dropdowns
            const models = [...new Set(PIECES.map(w => w.model).filter(Boolean))].sort();
            populateDropdown(['filter-model', 'filter-model-m'], models, 'Model');

            const dials = [...new Set(PIECES.map(w => w.dialColor).filter(Boolean))].sort();
            populateDropdown(['filter-dial', 'filter-dial-m'], dials, 'Dial Color');

            const materials = [...new Set(PIECES.map(w => w.caseMaterial).filter(Boolean))].sort();
            populateDropdown(['filter-material', 'filter-material-m'], materials, 'Case Material');

            const conditions = [...new Set(PIECES.map(w => w.condition).filter(Boolean))].sort();
            populateDropdown(['filter-condition', 'filter-condition-m'], conditions, 'Condition');

            renderGrid(PIECES);
            const rc = document.getElementById('result-count');
            if (rc) rc.textContent = PIECES.length + ' pieces';

            gsap.from('#watch-grid .watch-card', {
                opacity: 0, y: 50, scale: 0.97, duration: 0.7, stagger: 0.06, ease: 'power3.out',
                scrollTrigger: { trigger: '#watch-grid', start: 'top 85%' }
            });

            gsap.from('.glass.rounded-2xl', {
                scrollTrigger: { trigger: '.glass.rounded-2xl', start: 'top 85%' },
                opacity: 0, y: 40, duration: 0.9, ease: 'power3.out'
            });

            gsap.to('.footer-line', {
                opacity: 1, y: 0, duration: 0.6, stagger: 0.15, ease: 'power2.out',
                scrollTrigger: { trigger: 'footer', start: 'top 90%' }
            });
            gsap.from('.footer-line', {
                y: 20, duration: 0.6, stagger: 0.15, ease: 'power2.out',
                scrollTrigger: { trigger: 'footer', start: 'top 90%' }
            });
        });
    </script>
</body>
</html>
